# VAE-HyperNet-Fusion

**VAE-HyperNet-Fusion: A Generative Framework for Small Tabular Data Classification via Hypernetwork-Generated Soft Decision Trees**

## Overview

This repository provides the source code for reproducing the experimental results presented in the paper. The proposed VAE-HyperNet-Fusion (VAE-HNF) framework combines three key components:

1. **Variational Autoencoder (VAE):** Learns the latent distribution of small tabular datasets and generates synthetic training samples via interpolation in latent space.
2. **Multi-Head Hypernetwork:** Encodes the (augmented) training set into a context vector and dynamically generates all parameters of the target classifier.
3. **Soft Decision Tree Ensemble:** A differentiable ensemble of soft decision trees whose weights are generated by the hypernetwork, enabling end-to-end gradient-based learning.

## Repository Structure

```
submission_code/
├── README.md                  # This file
├── requirements.txt           # Python dependencies
├── model.py                   # Core VAE-HNF model definition
├── run_experiment.py          # Reproduce Table II (6-model comparison)
├── run_ablation.py            # Reproduce Table III (ablation study)
├── data_loader.py             # Dataset loading utilities
└── data/
    └── prostate.csv           # Prostate Cancer dataset (dataset #0)
```

## Requirements

- Python >= 3.8
- PyTorch >= 1.9.0
- scikit-learn >= 1.0.0
- numpy >= 1.20.0
- pandas >= 1.3.0
- optuna >= 3.0.0 (for hyperparameter tuning)
- matplotlib >= 3.4.0 (for figure generation)

Install dependencies:
```bash
pip install -r requirements.txt
```

## Hardware

All experiments were conducted on a server equipped with:
- 2× Intel Xeon Gold 6348 CPUs (2.60 GHz, 28 cores each, 112 threads total)
- 1 TB DDR4 RAM
- 8× NVIDIA A100-SXM4 GPUs (80 GB HBM2e each)
- Ubuntu 24.04 LTS, CUDA 12.6

## Quick Start

### 1. Reproduce the main comparison (Table II)

```bash
python run_experiment.py --data_dir ./data --gpu 0
```

This runs 5-fold stratified cross-validation on all 11 datasets with all 6 methods (RF, XGBoost, TabPFN, HyperTab, AutoML/TPOT, and VAE-HNF). Results are saved to `output/`.

### 2. Reproduce the ablation study (Table III)

```bash
python run_ablation.py --data_dir ./data --gpu 0
```

This evaluates the contribution of each component (VAE augmentation, interpolation, hypernetwork parameterization, and ensembling).

### 3. Run on a single dataset

```python
from model import VAEHyperNetFusion, train_model, predict_model
from data_loader import load_dataset

X, y, name = load_dataset(0, data_dir='./data')
# ... see run_experiment.py for full workflow
```

## Datasets

| ID | Dataset | Samples | Features | Classes |
|----|---------|---------|----------|---------|
| 0 | Prostate Cancer | 26 | 4 | 2 |
| 1 | Balloons | 20 | 4 | 2 |
| 2 | Lenses | 24 | 4 | 3 |
| 3 | Caesarian Section | 80 | 5 | 2 |
| 4 | Iris | 150 | 4 | 3 |
| 5 | Fertility | 100 | 9 | 2 |
| 6 | Zoo | 101 | 16 | 7 |
| 7 | Seeds | 210 | 7 | 3 |
| 8 | Haberman's Survival | 306 | 3 | 2 |
| 9 | Glass Identification | 214 | 9 | 6 |
| 10 | Yeast | 1484 | 8 | 10 |

Dataset #0 (Prostate Cancer) is included in `data/`. Datasets #1–10 are publicly available from the [UCI Machine Learning Repository](https://archive.ics.uci.edu/ml/index.php).

## Citation

If you find this code useful, please cite our paper:

```bibtex
@article{zhang2026vae,
  title={VAE-HyperNet-Fusion: A Generative Framework for Small Tabular Data
         Classification via Hypernetwork-Generated Soft Decision Trees},
  author={Zhang, Jinming},
  year={2026}
}
```

## License

This project is released under the MIT License.
