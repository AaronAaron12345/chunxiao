# Ablation Study Results (v2 — Optuna Optimized)

**实验配置**: 5-fold Stratified Cross-Validation | 11 Datasets | 7 Ablation Variants + RF Baseline

**实验时间**: 2026-02-08 | 总耗时: ~27 分钟 (385 tasks, 5 GPUs × 3 workers)

**关键改进**: 每个数据集使用 Optuna 贝叶斯搜索到的最优超参数（v1 使用固定默认值）

---

## 1. 消融变体说明

| 变体代号 | 名称 | 说明 |
|:------:|:-----|:-----|
| **RF** | Random Forest Baseline | 随机森林基线 (100棵树) |
| **A** | Full Model | 完整模型 (VAE + HyperNet + Ensemble + Multi-head + Interpolation) |
| **B** | No VAE Augmentation | 移除 VAE 数据增强，仅使用原始数据 |
| **C** | No Interpolation | 移除插值噪声 (noise_scale=0, VAE纯重建) |
| **D** | No HyperNet | 移除超网络，直接反向传播训练 SoftTree 参数 |
| **E** | No Ensemble | 仅使用 1 个头 + 1 棵树 (完整模型使用优化后的多棵树) |
| **F** | No Multi-Head | 超网络使用单头 (保留优化后的树数量) |
| **G** | VAE + RF | 仅使用 VAE 增强数据 + 随机森林 |

---

## 2. 主结果表 (Accuracy: Mean±Std %)

| Dataset (N) | RF | A: Full | B: −VAE | C: −Interp | D: −HyperNet | E: −Ensemble | F: −MultiHead | G: VAE+RF |
|:------------|:---:|:------:|:------:|:----------:|:------------:|:------------:|:-------------:|:---------:|
| Prostate (26) | 81.3±16.5 | **84.7±7.8** | 77.3±13.7 | 76.7±15.2 | 61.3±2.7 | 84.7±7.8 | 84.7±7.8 | 81.3±24.4 |
| Balloons (20) | **100.0±0.0** | 100.0±0.0 | 100.0±0.0 | 100.0±0.0 | 100.0±0.0 | 100.0±0.0 | 100.0±0.0 | 100.0±0.0 |
| Lenses (24) | 84.0±15.0 | 92.0±9.8 | 92.0±9.8 | 92.0±9.8 | 67.0±8.7 | **96.0±8.0** | 87.0±10.8 | 87.0±16.6 |
| Caesarian (80) | 57.5±7.3 | **76.2±8.3** | 72.5±8.5 | 75.0±6.8 | 72.5±7.5 | 76.2±6.1 | 75.0±8.8 | 56.2±6.8 |
| Iris (150) | 94.7±2.7 | **98.0±2.7** | 96.7±3.0 | 97.3±3.3 | 96.7±4.2 | 97.3±3.9 | 94.7±7.5 | 95.3±3.4 |
| Fertility (100) | 86.0±3.7 | **91.0±2.0** | 90.0±3.2 | 91.0±2.0 | 89.0±2.0 | 89.0±2.0 | 89.0±3.7 | 87.0±5.1 |
| Zoo (101) | 97.0±2.4 | **99.0±2.0** | 97.0±2.4 | 98.0±2.4 | 95.0±3.2 | 97.0±2.4 | 98.0±2.4 | 95.0±0.1 |
| Seeds (210) | 91.9±3.9 | **95.2±2.6** | 93.3±4.9 | 94.8±3.2 | 93.8±2.9 | 82.4±15.0 | 93.8±2.9 | 91.4±3.2 |
| Haberman (306) | 68.3±3.0 | **77.8±3.1** | 76.8±2.7 | 76.8±3.0 | 77.1±3.1 | 75.5±3.0 | 76.8±2.7 | 69.3±3.5 |
| Glass (214) | **76.2±4.0** | 72.9±4.7 | 72.9±1.3 | 72.9±6.4 | 69.6±3.5 | 58.4±6.7 | 67.3±4.7 | 74.3±2.2 |
| Yeast (1484) | 61.3±2.9 | 61.3±2.6 | 60.2±4.1 | 61.2±2.9 | 59.9±2.8 | 54.3±7.9 | 57.7±4.9 | **61.8±2.7** |
| **平均** | **81.7** | **86.2** | **84.4** | **85.1** | **80.2** | **82.8** | **84.0** | **81.7** |

---

## 3. 组件贡献分析 (Δ Accuracy = Full Model − Ablated Variant)

> 正值 (+) 表示该组件对模型有正面贡献（移除后性能下降）

| Dataset | VAE Aug (A−B) | Interpolation (A−C) | HyperNet (A−D) | Ensemble (A−E) | Multi-Head (A−F) |
|:--------|:------------:|:-------------------:|:--------------:|:--------------:|:----------------:|
| Prostate | **+7.3** | +8.0 | **+23.3** | 0.0 | 0.0 |
| Balloons | 0.0 | 0.0 | 0.0 | 0.0 | 0.0 |
| Lenses | 0.0 | 0.0 | **+25.0** | −4.0 | +5.0 |
| Caesarian | +3.8 | +1.2 | +3.8 | 0.0 | +1.2 |
| Iris | +1.3 | +0.7 | +1.3 | +0.7 | **+3.3** |
| Fertility | +1.0 | 0.0 | +2.0 | +2.0 | +2.0 |
| Zoo | +2.0 | +1.0 | +4.0 | +2.0 | +1.0 |
| Seeds | +1.9 | +0.5 | +1.4 | **+12.9** | +1.4 |
| Haberman | +1.0 | +1.0 | +0.7 | +2.3 | +1.0 |
| Glass | 0.0 | 0.0 | +3.3 | **+14.5** | **+5.6** |
| Yeast | +1.0 | +0.1 | +1.3 | **+6.9** | **+3.6** |
| **平均 Δ** | **+1.8** | **+1.1** | **+6.0** | **+3.4** | **+2.2** |

---

## 4. 组件重要性排序

| 排名 | 组件 | 平均贡献 (Δ%) | 解读 |
|:---:|:-----|:------------:|:-----|
| 1 | **HyperNet** 超网络参数化 | **+6.0** | 最关键组件，移除后平均下降 6.0%。在 Lenses (+25.0%) 和 Prostate (+23.3%) 上效果极为显著 |
| 2 | **Ensemble** 多树集成 | **+3.4** | 第二重要，在 Glass (+14.5%)、Seeds (+12.9%)、Yeast (+6.9%) 上贡献突出 |
| 3 | **Multi-Head** 多头超网络 | **+2.2** | 在 Glass (+5.6%)、Lenses (+5.0%)、Yeast (+3.6%) 上增加有效多样性 |
| 4 | **VAE Augmentation** VAE数据增强 | **+1.8** | 在 Prostate (+7.3%)、Caesarian (+3.8%) 等小样本数据集上贡献明显 |
| 5 | **Interpolation** 插值噪声 | **+1.1** | 在 Prostate (+8.0%) 上效果显著，整体贡献正向 |

---

## 5. Full Model vs RF Baseline 对比

| Dataset | RF Baseline | Full Model (v2) | Δ (Full−RF) | 胜负 |
|:--------|:----------:|:----------:|:-----------:|:---:|
| Prostate (26) | 81.3 | **84.7** | **+3.4** | ✅ Full |
| Balloons (20) | 100.0 | 100.0 | 0.0 | Tie |
| Lenses (24) | 84.0 | **92.0** | **+8.0** | ✅ Full |
| Caesarian (80) | 57.5 | **76.2** | **+18.7** | ✅ Full |
| Iris (150) | 94.7 | **98.0** | **+3.3** | ✅ Full |
| Fertility (100) | 86.0 | **91.0** | **+5.0** | ✅ Full |
| Zoo (101) | 97.0 | **99.0** | **+2.0** | ✅ Full |
| Seeds (210) | 91.9 | **95.2** | **+3.3** | ✅ Full |
| Haberman (306) | 68.3 | **77.8** | **+9.5** | ✅ Full |
| Glass (214) | **76.2** | 72.9 | −3.3 | RF |
| Yeast (1484) | 61.3 | 61.3 | 0.0 | Tie |
| **平均** | **81.7** | **86.2** | **+4.5** | ✅ Full |

> Full Model 在 **8/11** 数据集上优于 RF（v1 仅 4/11），平均提升 4.5%（v1 仅 +0.4%）。

---

## 6. v2 vs v1 对比 (Optuna优化 vs 默认参数)

| Dataset | v1 Full (默认参数) | v2 Full (Optuna) | 提升 |
|:--------|:---------:|:--------:|:----:|
| Prostate | 80.7% | **84.7%** | +4.0 |
| Balloons | 100.0% | 100.0% | 0.0 |
| Lenses | 75.0% | **92.0%** | **+17.0** |
| Caesarian | 75.0% | **76.2%** | +1.2 |
| Iris | 94.7% | **98.0%** | +3.3 |
| Fertility | 88.0% | **91.0%** | +3.0 |
| Zoo | 92.1% | **99.0%** | **+6.9** |
| Seeds | 94.3% | **95.2%** | +0.9 |
| Haberman | 77.1% | **77.8%** | +0.6 |
| Glass | 68.2% | **72.9%** | +4.7 |
| Yeast | 57.4% | **61.3%** | +3.8 |
| **平均** | **82.0%** | **86.2%** | **+4.2** |

---

## 7. 关键发现

1. **超网络 (HyperNet) 是核心组件**: 平均贡献 **+6.0%**（v1 为 +2.88%），Optuna 优化后重要性进一步凸显。在 Lenses (+25.0%) 和 Prostate (+23.3%) 上效果极为显著，验证了超网络通过参数共享实现知识迁移的有效性。

2. **集成 (Ensemble) 贡献大幅提升**: 平均贡献 **+3.4%**（v1 为 +1.51%），在 Glass (+14.5%)、Seeds (+12.9%)、Yeast (+6.9%) 上多树集成有效降低了方差。

3. **多头机制 (Multi-Head) 正面效果显著**: 平均贡献 **+2.2%**（v1 为 +0.82%），5 个独立头部提供的参数多样性在优化参数下更好地发挥了作用。

4. **VAE 增强 v2 转为正向贡献**: 平均贡献 **+1.8%**（v1 为 −0.25%），优化后的 VAE 参数（增强数量、噪声尺度等）使数据增强真正发挥了作用。

5. **所有 5 个组件均有正向贡献**: v1 中 VAE 和 Interpolation 是负向的，v2 优化参数后**全部正向**，验证了架构设计的合理性和超参数优化的必要性。

6. **Full Model 大幅领先 RF**: 平均准确率 **86.2% vs 81.7%**（+4.5pp），8/11 数据集胜出。

---

*Results generated by `62_ablation_v2.py` | VAE-HyperNet-Fusion Ablation Study v2 (Optuna Optimized)*
